<?php
// Adicionar “Landing Page Clean” à lista suspensa de modelos de página do editor. Quando o usuário escolhe esse modelo, WP salva page-landing-clean.php como page template slug
add_filter('theme_page_templates', function ($templates) {
	$templates['page-landing-clean.php'] = 'Landing Page Clean';
	return $templates;
});

// Quando WP carrega uma página, verifica se o slug do modelo é page-landing-clean.php. Se sim, força o carregamento do arquivo físico page-landing-clean.php dentro do tema (ou child-theme). Evita erros 404 caso o tema não localize sozinho.
add_filter('template_include', function ($template) {
	if (is_page()) {
		$page_template = get_page_template_slug(get_queried_object_id());
		if ($page_template === 'page-landing-clean.php') {
			$custom = locate_template('page-landing-clean.php');
			if ($custom) {
				return $custom;
			}
		}
	}
	return $template;
});

// Chamada apenas quando o plugin é ativado, verifica se existe a página com slug landing-hero, se não existir cria
add_action('after_setup_theme', function () {
	$slug = 'landing-hero';
	$page = get_page_by_path($slug);

	if (!$page) {
		$page_id = wp_insert_post([
			'post_title'     => 'Landing Hero',
			'post_name'      => $slug,
			'post_status'    => 'publish',
			'post_type'      => 'page',
			'page_template'  => 'page-landing-clean.php',
			'post_content'   => '[shortcode_content]',
		]);
	}
});
?>
